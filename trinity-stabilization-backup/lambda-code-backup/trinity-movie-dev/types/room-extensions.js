"use strict";
/**
 * Room Extensions for Advanced Content Filtering
 *
 * This file extends the existing Room interface to support advanced content filtering
 * while maintaining backward compatibility with existing rooms.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.hasFilteringEnabled = hasFilteringEnabled;
exports.isLegacyRoom = isLegacyRoom;
exports.getEffectiveGenres = getEffectiveGenres;
exports.needsContentRefresh = needsContentRefresh;
// ============================================================================
// Validation Helpers
// ============================================================================
/**
 * Validates if a room has filtering enabled
 */
function hasFilteringEnabled(room) {
    return !!(room.mediaType && room.genreIds && room.genreIds.length > 0);
}
/**
 * Validates if a room is legacy (no filtering)
 */
function isLegacyRoom(room) {
    return !room.mediaType && !room.genreIds;
}
/**
 * Gets the effective genre preferences for a room (new or legacy)
 */
function getEffectiveGenres(room) {
    if (room.genreNames && room.genreNames.length > 0) {
        return room.genreNames;
    }
    if (room.genrePreferences && room.genrePreferences.length > 0) {
        return room.genrePreferences;
    }
    return [];
}
/**
 * Checks if room needs content refresh
 */
function needsContentRefresh(room) {
    if (!room.contentIds || !room.currentContentIndex) {
        return true;
    }
    const remaining = room.contentIds.length - room.currentContentIndex;
    return remaining < 5; // Refresh when fewer than 5 titles remaining
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm9vbS1leHRlbnNpb25zLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsicm9vbS1leHRlbnNpb25zLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7R0FLRzs7QUEwSUgsa0RBRUM7QUFLRCxvQ0FFQztBQUtELGdEQVVDO0FBS0Qsa0RBT0M7QUEzQ0QsK0VBQStFO0FBQy9FLHFCQUFxQjtBQUNyQiwrRUFBK0U7QUFFL0U7O0dBRUc7QUFDSCxTQUFnQixtQkFBbUIsQ0FBQyxJQUF1QjtJQUN6RCxPQUFPLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksSUFBSSxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQztBQUN6RSxDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFnQixZQUFZLENBQUMsSUFBdUI7SUFDbEQsT0FBTyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDO0FBQzNDLENBQUM7QUFFRDs7R0FFRztBQUNILFNBQWdCLGtCQUFrQixDQUFDLElBQXVCO0lBQ3hELElBQUksSUFBSSxDQUFDLFVBQVUsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztRQUNsRCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUM7SUFDekIsQ0FBQztJQUVELElBQUksSUFBSSxDQUFDLGdCQUFnQixJQUFJLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7UUFDOUQsT0FBTyxJQUFJLENBQUMsZ0JBQWdCLENBQUM7SUFDL0IsQ0FBQztJQUVELE9BQU8sRUFBRSxDQUFDO0FBQ1osQ0FBQztBQUVEOztHQUVHO0FBQ0gsU0FBZ0IsbUJBQW1CLENBQUMsSUFBdUI7SUFDekQsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLElBQUksQ0FBQyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztRQUNsRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFFRCxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsbUJBQW1CLENBQUM7SUFDcEUsT0FBTyxTQUFTLEdBQUcsQ0FBQyxDQUFDLENBQUMsNkNBQTZDO0FBQ3JFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogUm9vbSBFeHRlbnNpb25zIGZvciBBZHZhbmNlZCBDb250ZW50IEZpbHRlcmluZ1xyXG4gKiBcclxuICogVGhpcyBmaWxlIGV4dGVuZHMgdGhlIGV4aXN0aW5nIFJvb20gaW50ZXJmYWNlIHRvIHN1cHBvcnQgYWR2YW5jZWQgY29udGVudCBmaWx0ZXJpbmdcclxuICogd2hpbGUgbWFpbnRhaW5pbmcgYmFja3dhcmQgY29tcGF0aWJpbGl0eSB3aXRoIGV4aXN0aW5nIHJvb21zLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEZpbHRlckNyaXRlcmlhLCBDb250ZW50UG9vbEVudHJ5LCBNZWRpYVR5cGUgfSBmcm9tICcuL2NvbnRlbnQtZmlsdGVyaW5nJztcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gRXh0ZW5kZWQgUm9vbSBJbnRlcmZhY2VcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEV4dGVuZGVkIFJvb20gaW50ZXJmYWNlIHRoYXQgaW5jbHVkZXMgb3B0aW9uYWwgZmlsdGVyaW5nIGNhcGFiaWxpdGllc1xyXG4gKiB3aGlsZSBtYWludGFpbmluZyBmdWxsIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgd2l0aCBleGlzdGluZyByb29tc1xyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBSb29tV2l0aEZpbHRlcmluZyB7XHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gIC8vIEV4aXN0aW5nIFJvb20gRmllbGRzIChmcm9tIEdyYXBoUUwgc2NoZW1hKVxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICBpZDogc3RyaW5nO1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBkZXNjcmlwdGlvbj86IHN0cmluZztcclxuICBzdGF0dXM6IHN0cmluZztcclxuICByZXN1bHRNb3ZpZUlkPzogc3RyaW5nO1xyXG4gIGhvc3RJZDogc3RyaW5nO1xyXG4gIGludml0ZUNvZGU/OiBzdHJpbmc7XHJcbiAgaW52aXRlVXJsPzogc3RyaW5nO1xyXG4gIFxyXG4gIC8vIExlZ2FjeSBmaWVsZHMgKGRlcHJlY2F0ZWQgYnV0IG1haW50YWluZWQgZm9yIGNvbXBhdGliaWxpdHkpXHJcbiAgZ2VucmVQcmVmZXJlbmNlcz86IHN0cmluZ1tdO1xyXG4gIFxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAvLyBOZXcgQWR2YW5jZWQgRmlsdGVyaW5nIEZpZWxkc1xyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICBcclxuICAvLyBDb3JlIGZpbHRlcmluZyBjb25maWd1cmF0aW9uIChvcHRpb25hbCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSlcclxuICBtZWRpYVR5cGU/OiBNZWRpYVR5cGU7ICAgICAgICAgICAvLyBNT1ZJRSBvciBUVlxyXG4gIGdlbnJlSWRzPzogbnVtYmVyW107ICAgICAgICAgICAgIC8vIFRNREIgZ2VucmUgSURzIChtYXggMylcclxuICBnZW5yZU5hbWVzPzogc3RyaW5nW107ICAgICAgICAgICAvLyBIdW1hbi1yZWFkYWJsZSBnZW5yZSBuYW1lc1xyXG4gIFxyXG4gIC8vIENvbnRlbnQgcG9vbCBtYW5hZ2VtZW50XHJcbiAgY29udGVudElkcz86IHN0cmluZ1tdOyAgICAgICAgICAgLy8gSURzIG9mIHRoZSAzMCBwcmUtbG9hZGVkIHRpdGxlc1xyXG4gIGN1cnJlbnRDb250ZW50SW5kZXg/OiBudW1iZXI7ICAgIC8vIEN1cnJlbnQgcG9zaXRpb24gaW4gY29udGVudElkcyBhcnJheVxyXG4gIGV4Y2x1ZGVkQ29udGVudElkcz86IHN0cmluZ1tdOyAgIC8vIElEcyBvZiB0aXRsZXMgYWxyZWFkeSBzaG93blxyXG4gIGxhc3RDb250ZW50UmVmcmVzaD86IHN0cmluZzsgICAgIC8vIElTTyB0aW1lc3RhbXAgb2YgbGFzdCBjb250ZW50IHJlbG9hZFxyXG4gIFxyXG4gIC8vIFJvb20gc3RhdGVcclxuICBpc0FjdGl2ZTogYm9vbGVhbjtcclxuICBpc1ByaXZhdGU6IGJvb2xlYW47XHJcbiAgbWVtYmVyQ291bnQ6IG51bWJlcjtcclxuICBtYXhNZW1iZXJzPzogbnVtYmVyO1xyXG4gIG1hdGNoQ291bnQ/OiBudW1iZXI7XHJcbiAgY3JlYXRlZEF0OiBzdHJpbmc7ICAgICAgICAgICAgICAgLy8gSVNPIHRpbWVzdGFtcFxyXG4gIHVwZGF0ZWRBdD86IHN0cmluZzsgICAgICAgICAgICAgIC8vIElTTyB0aW1lc3RhbXBcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBSb29tIENyZWF0aW9uIElucHV0IEV4dGVuc2lvbnNcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEV4dGVuZGVkIGlucHV0IGZvciBjcmVhdGluZyByb29tcyB3aXRoIGZpbHRlcmluZyBjYXBhYmlsaXRpZXNcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ3JlYXRlUm9vbVdpdGhGaWx0ZXJpbmdJbnB1dCB7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xyXG4gIGlzUHJpdmF0ZT86IGJvb2xlYW47XHJcbiAgbWF4TWVtYmVycz86IG51bWJlcjtcclxuICBcclxuICAvLyBBZHZhbmNlZCBmaWx0ZXJpbmcgZmllbGRzXHJcbiAgbWVkaWFUeXBlOiBNZWRpYVR5cGU7ICAgICAgICAgICAgLy8gUmVxdWlyZWQgZm9yIG5ldyBmaWx0ZXJpbmcgc3lzdGVtXHJcbiAgZ2VucmVJZHM6IG51bWJlcltdOyAgICAgICAgICAgICAgLy8gVE1EQiBnZW5yZSBJRHMgKG1heCAzKVxyXG4gIFxyXG4gIC8vIExlZ2FjeSBmaWVsZCAoZGVwcmVjYXRlZCBidXQgbWFpbnRhaW5lZCBmb3IgY29tcGF0aWJpbGl0eSlcclxuICBnZW5yZVByZWZlcmVuY2VzPzogc3RyaW5nW107XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUm9vbSBVcGRhdGUgT3BlcmF0aW9uc1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogT3BlcmF0aW9ucyBmb3IgdXBkYXRpbmcgcm9vbSBjb250ZW50IHBvb2xcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ29udGVudFBvb2xVcGRhdGUge1xyXG4gIHJvb21JZDogc3RyaW5nO1xyXG4gIG5ld0NvbnRlbnRJZHM6IHN0cmluZ1tdO1xyXG4gIGV4Y2x1ZGVJZHM6IHN0cmluZ1tdO1xyXG4gIHJlZnJlc2hUaW1lc3RhbXA6IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIE9wZXJhdGlvbnMgZm9yIHRyYWNraW5nIHNob3duIGNvbnRlbnRcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2hvd25Db250ZW50VXBkYXRlIHtcclxuICByb29tSWQ6IHN0cmluZztcclxuICBzaG93bkNvbnRlbnRJZDogc3RyaW5nO1xyXG4gIHRpbWVzdGFtcDogc3RyaW5nO1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFJvb20gUXVlcnkgRmlsdGVyc1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogRmlsdGVycyBmb3IgcXVlcnlpbmcgcm9vbXMgd2l0aCBzcGVjaWZpYyBjcml0ZXJpYVxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBSb29tUXVlcnlGaWx0ZXJzIHtcclxuICBtZWRpYVR5cGU/OiBNZWRpYVR5cGU7XHJcbiAgZ2VucmVJZHM/OiBudW1iZXJbXTtcclxuICBpc0FjdGl2ZT86IGJvb2xlYW47XHJcbiAgaXNQcml2YXRlPzogYm9vbGVhbjtcclxuICBob3N0SWQ/OiBzdHJpbmc7XHJcbiAgY3JlYXRlZEFmdGVyPzogc3RyaW5nO1xyXG4gIGNyZWF0ZWRCZWZvcmU/OiBzdHJpbmc7XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUm9vbSBTdGF0aXN0aWNzXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBTdGF0aXN0aWNzIGFib3V0IHJvb20gY29udGVudCBhbmQgZmlsdGVyaW5nXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFJvb21Db250ZW50U3RhdHMge1xyXG4gIHJvb21JZDogc3RyaW5nO1xyXG4gIHRvdGFsQ29udGVudExvYWRlZDogbnVtYmVyO1xyXG4gIGNvbnRlbnRTaG93bjogbnVtYmVyO1xyXG4gIGNvbnRlbnRSZW1haW5pbmc6IG51bWJlcjtcclxuICBhdmVyYWdlVm90aW5nVGltZTogbnVtYmVyO1xyXG4gIGZpbHRlckVmZmVjdGl2ZW5lc3M6IG51bWJlcjsgICAgLy8gUGVyY2VudGFnZSBvZiBjb250ZW50IHRoYXQgbWF0Y2hlZCBmaWx0ZXJzXHJcbiAgbGFzdFJlZnJlc2hUaW1lOiBzdHJpbmc7XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gVmFsaWRhdGlvbiBIZWxwZXJzXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBWYWxpZGF0ZXMgaWYgYSByb29tIGhhcyBmaWx0ZXJpbmcgZW5hYmxlZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGhhc0ZpbHRlcmluZ0VuYWJsZWQocm9vbTogUm9vbVdpdGhGaWx0ZXJpbmcpOiBib29sZWFuIHtcclxuICByZXR1cm4gISEocm9vbS5tZWRpYVR5cGUgJiYgcm9vbS5nZW5yZUlkcyAmJiByb29tLmdlbnJlSWRzLmxlbmd0aCA+IDApO1xyXG59XHJcblxyXG4vKipcclxuICogVmFsaWRhdGVzIGlmIGEgcm9vbSBpcyBsZWdhY3kgKG5vIGZpbHRlcmluZylcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0xlZ2FjeVJvb20ocm9vbTogUm9vbVdpdGhGaWx0ZXJpbmcpOiBib29sZWFuIHtcclxuICByZXR1cm4gIXJvb20ubWVkaWFUeXBlICYmICFyb29tLmdlbnJlSWRzO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0cyB0aGUgZWZmZWN0aXZlIGdlbnJlIHByZWZlcmVuY2VzIGZvciBhIHJvb20gKG5ldyBvciBsZWdhY3kpXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RWZmZWN0aXZlR2VucmVzKHJvb206IFJvb21XaXRoRmlsdGVyaW5nKTogc3RyaW5nW10ge1xyXG4gIGlmIChyb29tLmdlbnJlTmFtZXMgJiYgcm9vbS5nZW5yZU5hbWVzLmxlbmd0aCA+IDApIHtcclxuICAgIHJldHVybiByb29tLmdlbnJlTmFtZXM7XHJcbiAgfVxyXG4gIFxyXG4gIGlmIChyb29tLmdlbnJlUHJlZmVyZW5jZXMgJiYgcm9vbS5nZW5yZVByZWZlcmVuY2VzLmxlbmd0aCA+IDApIHtcclxuICAgIHJldHVybiByb29tLmdlbnJlUHJlZmVyZW5jZXM7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiBbXTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrcyBpZiByb29tIG5lZWRzIGNvbnRlbnQgcmVmcmVzaFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIG5lZWRzQ29udGVudFJlZnJlc2gocm9vbTogUm9vbVdpdGhGaWx0ZXJpbmcpOiBib29sZWFuIHtcclxuICBpZiAoIXJvb20uY29udGVudElkcyB8fCAhcm9vbS5jdXJyZW50Q29udGVudEluZGV4KSB7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcbiAgXHJcbiAgY29uc3QgcmVtYWluaW5nID0gcm9vbS5jb250ZW50SWRzLmxlbmd0aCAtIHJvb20uY3VycmVudENvbnRlbnRJbmRleDtcclxuICByZXR1cm4gcmVtYWluaW5nIDwgNTsgLy8gUmVmcmVzaCB3aGVuIGZld2VyIHRoYW4gNSB0aXRsZXMgcmVtYWluaW5nXHJcbn0iXX0=