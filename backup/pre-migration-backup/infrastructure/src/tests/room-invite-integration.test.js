"use strict";
/**
 * Integration Tests for Room Handler with Invite System
 * Feature: trinity-voting-fixes
 *
 * Tests the integration between Room Handler and Deep Link Service
 */
Object.defineProperty(exports, "__esModule", { value: true });
const deepLinkService_1 = require("../services/deepLinkService");
describe('Room Handler - Invite System Integration', () => {
    let deepLinkService;
    beforeEach(() => {
        // Create DeepLinkService instance for testing
        deepLinkService = new deepLinkService_1.DeepLinkService();
        // Set up environment variables
        process.env.INVITE_LINKS_TABLE = 'test-invite-links-table';
        process.env.ROOMS_TABLE = 'test-rooms-table';
    });
    describe('Invite Code Generation Logic', () => {
        it('should generate invite codes with correct format', () => {
            // Test the private method by accessing it
            const generateMethod = deepLinkService.generateRandomCode;
            const code = generateMethod.call(deepLinkService);
            expect(code).toBeDefined();
            expect(typeof code).toBe('string');
            expect(code.length).toBe(6);
            expect(code).toMatch(/^[A-Z0-9]{6}$/);
        });
        it('should generate different codes on multiple calls', () => {
            const generateMethod = deepLinkService.generateRandomCode;
            const codes = new Set();
            // Generate 100 codes to test uniqueness
            for (let i = 0; i < 100; i++) {
                const code = generateMethod.call(deepLinkService);
                codes.add(code);
            }
            // Should have high uniqueness (allow for some collisions in random generation)
            expect(codes.size).toBeGreaterThan(90);
        });
        it('should generate codes using only valid characters', () => {
            const generateMethod = deepLinkService.generateRandomCode;
            const validChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            for (let i = 0; i < 50; i++) {
                const code = generateMethod.call(deepLinkService);
                for (const char of code) {
                    expect(validChars.includes(char)).toBe(true);
                }
            }
        });
    });
    describe('URL Format Validation', () => {
        it('should extract invite codes from various URL formats', () => {
            const testCases = [
                { url: 'https://trinity.app/room/ABC123', expected: 'ABC123' },
                { url: 'trinity.app/room/XYZ789', expected: 'XYZ789' },
                { url: '/room/DEF456', expected: 'DEF456' },
                { url: 'GHI012', expected: 'GHI012' },
            ];
            testCases.forEach(({ url, expected }) => {
                // Access private method for testing
                const extractMethod = deepLinkService.extractInviteCodeFromUrl;
                const result = extractMethod.call(deepLinkService, url);
                expect(result).toBe(expected);
            });
        });
        it('should reject invalid URL formats', () => {
            const invalidUrls = [
                'https://example.com/room/ABC123', // Wrong domain
                'https://trinity.app/invalid/ABC123', // Wrong path
                'https://trinity.app/room/ABC12', // Too short
                'https://trinity.app/room/ABCDEFG', // Too long
                'invalid-format', // No valid pattern
                '', // Empty
            ];
            invalidUrls.forEach(url => {
                // Access private method for testing
                const extractMethod = deepLinkService.extractInviteCodeFromUrl;
                const result = extractMethod.call(deepLinkService, url);
                expect(result).toBeNull();
            });
        });
        it('should handle case insensitive extraction', () => {
            const testCases = [
                { url: 'https://trinity.app/room/abc123', expected: 'ABC123' },
                { url: 'trinity.app/room/xyz789', expected: 'XYZ789' },
                { url: '/room/def456', expected: 'DEF456' },
                { url: 'ghi012', expected: 'GHI012' },
            ];
            testCases.forEach(({ url, expected }) => {
                const extractMethod = deepLinkService.extractInviteCodeFromUrl;
                const result = extractMethod.call(deepLinkService, url);
                expect(result).toBe(expected);
            });
        });
    });
    describe('URL Generation', () => {
        it('should generate correct base URL format', () => {
            const baseUrl = 'https://trinity.app';
            const inviteCode = 'ABC123';
            const expectedUrl = `${baseUrl}/room/${inviteCode}`;
            // Test URL construction logic
            expect(`${baseUrl}/room/${inviteCode}`).toBe(expectedUrl);
        });
        it('should maintain consistency between URL generation and parsing', () => {
            const testCodes = ['ABC123', 'XYZ789', 'DEF456', 'GHI012'];
            testCodes.forEach(code => {
                const url = `https://trinity.app/room/${code}`;
                // Extract code from generated URL
                const extractMethod = deepLinkService.extractInviteCodeFromUrl;
                const extractedCode = extractMethod.call(deepLinkService, url);
                expect(extractedCode).toBe(code);
            });
        });
    });
    describe('Invite Link Structure', () => {
        it('should create invite link objects with correct structure', () => {
            const mockInviteLink = {
                code: 'ABC123',
                url: 'https://trinity.app/room/ABC123',
                roomId: 'room-123',
                createdBy: 'user-456',
                createdAt: new Date().toISOString(),
                expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(),
                isActive: true,
                usageCount: 0,
            };
            // Validate structure
            expect(mockInviteLink.code).toMatch(/^[A-Z0-9]{6}$/);
            expect(mockInviteLink.url).toBe(`https://trinity.app/room/${mockInviteLink.code}`);
            expect(mockInviteLink.roomId).toBeDefined();
            expect(mockInviteLink.createdBy).toBeDefined();
            expect(mockInviteLink.isActive).toBe(true);
            expect(mockInviteLink.usageCount).toBe(0);
            // Validate timestamps
            const createdTime = new Date(mockInviteLink.createdAt);
            const expiryTime = new Date(mockInviteLink.expiresAt);
            expect(expiryTime.getTime()).toBeGreaterThan(createdTime.getTime());
        });
        it('should calculate expiry times correctly', () => {
            const now = new Date();
            const expiryHours = 24;
            const expectedExpiry = new Date(now.getTime() + (expiryHours * 60 * 60 * 1000));
            // Test expiry calculation logic
            const calculatedExpiry = new Date(now.getTime() + (expiryHours * 60 * 60 * 1000));
            expect(Math.abs(calculatedExpiry.getTime() - expectedExpiry.getTime())).toBeLessThan(1000);
        });
    });
    describe('Room Info Structure', () => {
        it('should create room info objects with correct structure', () => {
            const mockRoomInfo = {
                roomId: 'room-123',
                name: 'Test Room',
                hostId: 'user-456',
                status: 'WAITING',
                memberCount: 1,
                isPrivate: false,
                createdAt: new Date().toISOString(),
            };
            // Validate structure
            expect(mockRoomInfo.roomId).toBeDefined();
            expect(mockRoomInfo.name).toBeDefined();
            expect(mockRoomInfo.hostId).toBeDefined();
            expect(mockRoomInfo.status).toBeDefined();
            expect(typeof mockRoomInfo.memberCount).toBe('number');
            expect(typeof mockRoomInfo.isPrivate).toBe('boolean');
            expect(mockRoomInfo.createdAt).toBeDefined();
            // Validate timestamp format
            expect(() => new Date(mockRoomInfo.createdAt)).not.toThrow();
        });
    });
    describe('Deep Link Action Structure', () => {
        it('should create valid JOIN_ROOM actions', () => {
            const joinAction = {
                type: 'JOIN_ROOM',
                roomId: 'room-123',
                metadata: {
                    roomName: 'Test Room',
                    hostId: 'user-456',
                    memberCount: 1,
                    inviteCode: 'ABC123',
                },
            };
            expect(joinAction.type).toBe('JOIN_ROOM');
            expect(joinAction.roomId).toBeDefined();
            expect(joinAction.metadata).toBeDefined();
            expect(joinAction.metadata.roomName).toBeDefined();
            expect(joinAction.metadata.inviteCode).toMatch(/^[A-Z0-9]{6}$/);
        });
        it('should create valid ERROR actions', () => {
            const errorAction = {
                type: 'ERROR',
                errorMessage: 'Invalid invite link format',
            };
            expect(errorAction.type).toBe('ERROR');
            expect(errorAction.errorMessage).toBeDefined();
            expect(typeof errorAction.errorMessage).toBe('string');
        });
        it('should create valid INVALID_CODE actions', () => {
            const invalidAction = {
                type: 'INVALID_CODE',
                errorMessage: 'This invite link is invalid or has expired',
            };
            expect(invalidAction.type).toBe('INVALID_CODE');
            expect(invalidAction.errorMessage).toBeDefined();
            expect(typeof invalidAction.errorMessage).toBe('string');
        });
    });
    describe('Integration Properties', () => {
        it('should maintain URL format consistency', () => {
            const baseUrl = 'https://trinity.app';
            const testCodes = ['ABC123', 'XYZ789', 'DEF456', 'GHI012', 'JKL345'];
            testCodes.forEach(code => {
                // Generate URL
                const url = `${baseUrl}/room/${code}`;
                // Extract code back
                const extractMethod = deepLinkService.extractInviteCodeFromUrl;
                const extractedCode = extractMethod.call(deepLinkService, url);
                // Should be consistent
                expect(extractedCode).toBe(code);
                expect(url).toBe(`${baseUrl}/room/${code}`);
            });
        });
        it('should handle edge cases in URL parsing', () => {
            const edgeCases = [
                { url: 'https://trinity.app/room/ABC123/', expected: null }, // Trailing slash not supported in backend
                { url: 'https://trinity.app/room/ABC123?param=value', expected: null }, // Query params not supported
                { url: 'https://trinity.app/room/ABC123#fragment', expected: null }, // Fragments not supported
            ];
            edgeCases.forEach(({ url, expected }) => {
                const extractMethod = deepLinkService.extractInviteCodeFromUrl;
                const result = extractMethod.call(deepLinkService, url);
                expect(result).toBe(expected);
            });
        });
        it('should validate invite code format consistently', () => {
            const validCodes = ['ABC123', 'XYZ789', 'DEF456', '123456', 'ABCDEF'];
            const invalidCodes = ['ABC12', 'ABCDEFG', 'abc123', 'ABC-23', 'ABC_23'];
            validCodes.forEach(code => {
                expect(code).toMatch(/^[A-Z0-9]{6}$/);
            });
            invalidCodes.forEach(code => {
                expect(code).not.toMatch(/^[A-Z0-9]{6}$/);
            });
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm9vbS1pbnZpdGUtaW50ZWdyYXRpb24udGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInJvb20taW52aXRlLWludGVncmF0aW9uLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7OztHQUtHOztBQUVILGlFQUE4RDtBQUU5RCxRQUFRLENBQUMsMENBQTBDLEVBQUUsR0FBRyxFQUFFO0lBQ3hELElBQUksZUFBZ0MsQ0FBQztJQUVyQyxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsOENBQThDO1FBQzlDLGVBQWUsR0FBRyxJQUFJLGlDQUFlLEVBQUUsQ0FBQztRQUV4QywrQkFBK0I7UUFDL0IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsR0FBRyx5QkFBeUIsQ0FBQztRQUMzRCxPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsR0FBRyxrQkFBa0IsQ0FBQztJQUMvQyxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyw4QkFBOEIsRUFBRSxHQUFHLEVBQUU7UUFDNUMsRUFBRSxDQUFDLGtEQUFrRCxFQUFFLEdBQUcsRUFBRTtZQUMxRCwwQ0FBMEM7WUFDMUMsTUFBTSxjQUFjLEdBQUksZUFBdUIsQ0FBQyxrQkFBa0IsQ0FBQztZQUNuRSxNQUFNLElBQUksR0FBRyxjQUFjLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBRWxELE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUMzQixNQUFNLENBQUMsT0FBTyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDbkMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDNUIsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUN4QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxtREFBbUQsRUFBRSxH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REFBaUQsRUFBRSxHQUFHLEVBQUU7WUFDekQsTUFBTSxVQUFVLEdBQUcsQ0FBQyxRQUFRLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDdEUsTUFBTSxZQUFZLEdBQUcsQ0FBQyxPQUFPLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFFeEUsVUFBVSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRTtnQkFDeEIsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUN4QyxDQUFDLENBQUMsQ0FBQztZQUVILFlBQVksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7Z0JBQzFCLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQzVDLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEludGVncmF0aW9uIFRlc3RzIGZvciBSb29tIEhhbmRsZXIgd2l0aCBJbnZpdGUgU3lzdGVtXHJcbiAqIEZlYXR1cmU6IHRyaW5pdHktdm90aW5nLWZpeGVzXHJcbiAqIFxyXG4gKiBUZXN0cyB0aGUgaW50ZWdyYXRpb24gYmV0d2VlbiBSb29tIEhhbmRsZXIgYW5kIERlZXAgTGluayBTZXJ2aWNlXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgRGVlcExpbmtTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvZGVlcExpbmtTZXJ2aWNlJztcclxuXHJcbmRlc2NyaWJlKCdSb29tIEhhbmRsZXIgLSBJbnZpdGUgU3lzdGVtIEludGVncmF0aW9uJywgKCkgPT4ge1xyXG4gIGxldCBkZWVwTGlua1NlcnZpY2U6IERlZXBMaW5rU2VydmljZTtcclxuXHJcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAvLyBDcmVhdGUgRGVlcExpbmtTZXJ2aWNlIGluc3RhbmNlIGZvciB0ZXN0aW5nXHJcbiAgICBkZWVwTGlua1NlcnZpY2UgPSBuZXcgRGVlcExpbmtTZXJ2aWNlKCk7XHJcbiAgICBcclxuICAgIC8vIFNldCB1cCBlbnZpcm9ubWVudCB2YXJpYWJsZXNcclxuICAgIHByb2Nlc3MuZW52LklOVklURV9MSU5LU19UQUJMRSA9ICd0ZXN0LWludml0ZS1saW5rcy10YWJsZSc7XHJcbiAgICBwcm9jZXNzLmVudi5ST09NU19UQUJMRSA9ICd0ZXN0LXJvb21zLXRhYmxlJztcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0ludml0ZSBDb2RlIEdlbmVyYXRpb24gTG9naWMnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIGludml0ZSBjb2RlcyB3aXRoIGNvcnJlY3QgZm9ybWF0JywgKCkgPT4ge1xyXG4gICAgICAvLyBUZXN0IHRoZSBwcml2YXRlIG1ldGhvZCBieSBhY2Nlc3NpbmcgaXRcclxuICAgICAgY29uc3QgZ2VuZXJhdGVNZXRob2QgPSAoZGVlcExpbmtTZXJ2aWNlIGFzIGFueSkuZ2VuZXJhdGVSYW5kb21Db2RlO1xyXG4gICAgICBjb25zdCBjb2RlID0gZ2VuZXJhdGVNZXRob2QuY2FsbChkZWVwTGlua1NlcnZpY2UpO1xyXG5cclxuICAgICAgZXhwZWN0KGNvZGUpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdCh0eXBlb2YgY29kZSkudG9CZSgnc3RyaW5nJyk7XHJcbiAgICAgIGV4cGVjdChjb2RlLmxlbmd0aCkudG9CZSg2KTtcclxuICAgICAgZXhwZWN0KGNvZGUpLnRvTWF0Y2goL15bQS1aMC05XXs2fSQvKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgZGlmZmVyZW50IGNvZGVzIG9uIG11bHRpcGxlIGNhbGxzJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBnZW5lcmF0ZU1ldGhvZCA9IChkZWVwTGlua1NlcnZpY2UgYXMgYW55KS5nZW5lcmF0ZVJhbmRvbUNvZGU7XHJcbiAgICAgIGNvbnN0IGNvZGVzID0gbmV3IFNldCgpO1xyXG4gICAgICBcclxuICAgICAgLy8gR2VuZXJhdGUgMTAwIGNvZGVzIHRvIHRlc3QgdW5pcXVlbmVzc1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgY29kZSA9IGdlbmVyYXRlTWV0aG9kLmNhbGwoZGVlcExpbmtTZXJ2aWNlKTtcclxuICAgICAgICBjb2Rlcy5hZGQoY29kZSk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIFNob3VsZCBoYXZlIGhpZ2ggdW5pcXVlbmVzcyAoYWxsb3cgZm9yIHNvbWUgY29sbGlzaW9ucyBpbiByYW5kb20gZ2VuZXJhdGlvbilcclxuICAgICAgZXhwZWN0KGNvZGVzLnNpemUpLnRvQmVHcmVhdGVyVGhhbig5MCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIGNvZGVzIHVzaW5nIG9ubHkgdmFsaWQgY2hhcmFjdGVycycsICgpID0+IHtcclxuICAgICAgY29uc3QgZ2VuZXJhdGVNZXRob2QgPSAoZGVlcExpbmtTZXJ2aWNlIGFzIGFueSkuZ2VuZXJhdGVSYW5kb21Db2RlO1xyXG4gICAgICBjb25zdCB2YWxpZENoYXJzID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaMDEyMzQ1Njc4OSc7XHJcbiAgICAgIFxyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDUwOyBpKyspIHtcclxuICAgICAgICBjb25zdCBjb2RlID0gZ2VuZXJhdGVNZXRob2QuY2FsbChkZWVwTGlua1NlcnZpY2UpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGZvciAoY29uc3QgY2hhciBvZiBjb2RlKSB7XHJcbiAgICAgICAgICBleHBlY3QodmFsaWRDaGFycy5pbmNsdWRlcyhjaGFyKSkudG9CZSh0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnVVJMIEZvcm1hdCBWYWxpZGF0aW9uJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBleHRyYWN0IGludml0ZSBjb2RlcyBmcm9tIHZhcmlvdXMgVVJMIGZvcm1hdHMnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHRlc3RDYXNlcyA9IFtcclxuICAgICAgICB7IHVybDogJ2h0dHBzOi8vdHJpbml0eS5hcHAvcm9vbS9BQkMxMjMnLCBleHBlY3RlZDogJ0FCQzEyMycgfSxcclxuICAgICAgICB7IHVybDogJ3RyaW5pdHkuYXBwL3Jvb20vWFlaNzg5JywgZXhwZWN0ZWQ6ICdYWVo3ODknIH0sXHJcbiAgICAgICAgeyB1cmw6ICcvcm9vbS9ERUY0NTYnLCBleHBlY3RlZDogJ0RFRjQ1NicgfSxcclxuICAgICAgICB7IHVybDogJ0dISTAxMicsIGV4cGVjdGVkOiAnR0hJMDEyJyB9LFxyXG4gICAgICBdO1xyXG5cclxuICAgICAgdGVzdENhc2VzLmZvckVhY2goKHsgdXJsLCBleHBlY3RlZCB9KSA9PiB7XHJcbiAgICAgICAgLy8gQWNjZXNzIHByaXZhdGUgbWV0aG9kIGZvciB0ZXN0aW5nXHJcbiAgICAgICAgY29uc3QgZXh0cmFjdE1ldGhvZCA9IChkZWVwTGlua1NlcnZpY2UgYXMgYW55KS5leHRyYWN0SW52aXRlQ29kZUZyb21Vcmw7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gZXh0cmFjdE1ldGhvZC5jYWxsKGRlZXBMaW5rU2VydmljZSwgdXJsKTtcclxuICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKGV4cGVjdGVkKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJlamVjdCBpbnZhbGlkIFVSTCBmb3JtYXRzJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBpbnZhbGlkVXJscyA9IFtcclxuICAgICAgICAnaHR0cHM6Ly9leGFtcGxlLmNvbS9yb29tL0FCQzEyMycsIC8vIFdyb25nIGRvbWFpblxyXG4gICAgICAgICdodHRwczovL3RyaW5pdHkuYXBwL2ludmFsaWQvQUJDMTIzJywgLy8gV3JvbmcgcGF0aFxyXG4gICAgICAgICdodHRwczovL3RyaW5pdHkuYXBwL3Jvb20vQUJDMTInLCAvLyBUb28gc2hvcnRcclxuICAgICAgICAnaHR0cHM6Ly90cmluaXR5LmFwcC9yb29tL0FCQ0RFRkcnLCAvLyBUb28gbG9uZ1xyXG4gICAgICAgICdpbnZhbGlkLWZvcm1hdCcsIC8vIE5vIHZhbGlkIHBhdHRlcm5cclxuICAgICAgICAnJywgLy8gRW1wdHlcclxuICAgICAgXTtcclxuXHJcbiAgICAgIGludmFsaWRVcmxzLmZvckVhY2godXJsID0+IHtcclxuICAgICAgICAvLyBBY2Nlc3MgcHJpdmF0ZSBtZXRob2QgZm9yIHRlc3RpbmdcclxuICAgICAgICBjb25zdCBleHRyYWN0TWV0aG9kID0gKGRlZXBMaW5rU2VydmljZSBhcyBhbnkpLmV4dHJhY3RJbnZpdGVDb2RlRnJvbVVybDtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBleHRyYWN0TWV0aG9kLmNhbGwoZGVlcExpbmtTZXJ2aWNlLCB1cmwpO1xyXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVOdWxsKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY2FzZSBpbnNlbnNpdGl2ZSBleHRyYWN0aW9uJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCB0ZXN0Q2FzZXMgPSBbXHJcbiAgICAgICAgeyB1cmw6ICdodHRwczovL3RyaW5pdHkuYXBwL3Jvb20vYWJjMTIzJywgZXhwZWN0ZWQ6ICdBQkMxMjMnIH0sXHJcbiAgICAgICAgeyB1cmw6ICd0cmluaXR5LmFwcC9yb29tL3h5ejc4OScsIGV4cGVjdGVkOiAnWFlaNzg5JyB9LFxyXG4gICAgICAgIHsgdXJsOiAnL3Jvb20vZGVmNDU2JywgZXhwZWN0ZWQ6ICdERUY0NTYnIH0sXHJcbiAgICAgICAgeyB1cmw6ICdnaGkwMTInLCBleHBlY3RlZDogJ0dISTAxMicgfSxcclxuICAgICAgXTtcclxuXHJcbiAgICAgIHRlc3RDYXNlcy5mb3JFYWNoKCh7IHVybCwgZXhwZWN0ZWQgfSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGV4dHJhY3RNZXRob2QgPSAoZGVlcExpbmtTZXJ2aWNlIGFzIGFueSkuZXh0cmFjdEludml0ZUNvZGVGcm9tVXJsO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGV4dHJhY3RNZXRob2QuY2FsbChkZWVwTGlua1NlcnZpY2UsIHVybCk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShleHBlY3RlZCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdVUkwgR2VuZXJhdGlvbicsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgY29ycmVjdCBiYXNlIFVSTCBmb3JtYXQnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGJhc2VVcmwgPSAnaHR0cHM6Ly90cmluaXR5LmFwcCc7XHJcbiAgICAgIGNvbnN0IGludml0ZUNvZGUgPSAnQUJDMTIzJztcclxuICAgICAgY29uc3QgZXhwZWN0ZWRVcmwgPSBgJHtiYXNlVXJsfS9yb29tLyR7aW52aXRlQ29kZX1gO1xyXG4gICAgICBcclxuICAgICAgLy8gVGVzdCBVUkwgY29uc3RydWN0aW9uIGxvZ2ljXHJcbiAgICAgIGV4cGVjdChgJHtiYXNlVXJsfS9yb29tLyR7aW52aXRlQ29kZX1gKS50b0JlKGV4cGVjdGVkVXJsKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgbWFpbnRhaW4gY29uc2lzdGVuY3kgYmV0d2VlbiBVUkwgZ2VuZXJhdGlvbiBhbmQgcGFyc2luZycsICgpID0+IHtcclxuICAgICAgY29uc3QgdGVzdENvZGVzID0gWydBQkMxMjMnLCAnWFlaNzg5JywgJ0RFRjQ1NicsICdHSEkwMTInXTtcclxuICAgICAgXHJcbiAgICAgIHRlc3RDb2Rlcy5mb3JFYWNoKGNvZGUgPT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwczovL3RyaW5pdHkuYXBwL3Jvb20vJHtjb2RlfWA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRXh0cmFjdCBjb2RlIGZyb20gZ2VuZXJhdGVkIFVSTFxyXG4gICAgICAgIGNvbnN0IGV4dHJhY3RNZXRob2QgPSAoZGVlcExpbmtTZXJ2aWNlIGFzIGFueSkuZXh0cmFjdEludml0ZUNvZGVGcm9tVXJsO1xyXG4gICAgICAgIGNvbnN0IGV4dHJhY3RlZENvZGUgPSBleHRyYWN0TWV0aG9kLmNhbGwoZGVlcExpbmtTZXJ2aWNlLCB1cmwpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cGVjdChleHRyYWN0ZWRDb2RlKS50b0JlKGNvZGUpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnSW52aXRlIExpbmsgU3RydWN0dXJlJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgaW52aXRlIGxpbmsgb2JqZWN0cyB3aXRoIGNvcnJlY3Qgc3RydWN0dXJlJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBtb2NrSW52aXRlTGluayA9IHtcclxuICAgICAgICBjb2RlOiAnQUJDMTIzJyxcclxuICAgICAgICB1cmw6ICdodHRwczovL3RyaW5pdHkuYXBwL3Jvb20vQUJDMTIzJyxcclxuICAgICAgICByb29tSWQ6ICdyb29tLTEyMycsXHJcbiAgICAgICAgY3JlYXRlZEJ5OiAndXNlci00NTYnLFxyXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIGV4cGlyZXNBdDogbmV3IERhdGUoRGF0ZS5ub3coKSArIDI0ICogNjAgKiA2MCAqIDEwMDApLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgaXNBY3RpdmU6IHRydWUsXHJcbiAgICAgICAgdXNhZ2VDb3VudDogMCxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIFZhbGlkYXRlIHN0cnVjdHVyZVxyXG4gICAgICBleHBlY3QobW9ja0ludml0ZUxpbmsuY29kZSkudG9NYXRjaCgvXltBLVowLTldezZ9JC8pO1xyXG4gICAgICBleHBlY3QobW9ja0ludml0ZUxpbmsudXJsKS50b0JlKGBodHRwczovL3RyaW5pdHkuYXBwL3Jvb20vJHttb2NrSW52aXRlTGluay5jb2RlfWApO1xyXG4gICAgICBleHBlY3QobW9ja0ludml0ZUxpbmsucm9vbUlkKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QobW9ja0ludml0ZUxpbmsuY3JlYXRlZEJ5KS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QobW9ja0ludml0ZUxpbmsuaXNBY3RpdmUpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIGV4cGVjdChtb2NrSW52aXRlTGluay51c2FnZUNvdW50KS50b0JlKDApO1xyXG4gICAgICBcclxuICAgICAgLy8gVmFsaWRhdGUgdGltZXN0YW1wc1xyXG4gICAgICBjb25zdCBjcmVhdGVkVGltZSA9IG5ldyBEYXRlKG1vY2tJbnZpdGVMaW5rLmNyZWF0ZWRBdCk7XHJcbiAgICAgIGNvbnN0IGV4cGlyeVRpbWUgPSBuZXcgRGF0ZShtb2NrSW52aXRlTGluay5leHBpcmVzQXQpO1xyXG4gICAgICBleHBlY3QoZXhwaXJ5VGltZS5nZXRUaW1lKCkpLnRvQmVHcmVhdGVyVGhhbihjcmVhdGVkVGltZS5nZXRUaW1lKCkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgZXhwaXJ5IHRpbWVzIGNvcnJlY3RseScsICgpID0+IHtcclxuICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcclxuICAgICAgY29uc3QgZXhwaXJ5SG91cnMgPSAyNDtcclxuICAgICAgY29uc3QgZXhwZWN0ZWRFeHBpcnkgPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpICsgKGV4cGlyeUhvdXJzICogNjAgKiA2MCAqIDEwMDApKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFRlc3QgZXhwaXJ5IGNhbGN1bGF0aW9uIGxvZ2ljXHJcbiAgICAgIGNvbnN0IGNhbGN1bGF0ZWRFeHBpcnkgPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpICsgKGV4cGlyeUhvdXJzICogNjAgKiA2MCAqIDEwMDApKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChNYXRoLmFicyhjYWxjdWxhdGVkRXhwaXJ5LmdldFRpbWUoKSAtIGV4cGVjdGVkRXhwaXJ5LmdldFRpbWUoKSkpLnRvQmVMZXNzVGhhbigxMDAwKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnUm9vbSBJbmZvIFN0cnVjdHVyZScsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgY3JlYXRlIHJvb20gaW5mbyBvYmplY3RzIHdpdGggY29ycmVjdCBzdHJ1Y3R1cmUnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IG1vY2tSb29tSW5mbyA9IHtcclxuICAgICAgICByb29tSWQ6ICdyb29tLTEyMycsXHJcbiAgICAgICAgbmFtZTogJ1Rlc3QgUm9vbScsXHJcbiAgICAgICAgaG9zdElkOiAndXNlci00NTYnLFxyXG4gICAgICAgIHN0YXR1czogJ1dBSVRJTkcnLFxyXG4gICAgICAgIG1lbWJlckNvdW50OiAxLFxyXG4gICAgICAgIGlzUHJpdmF0ZTogZmFsc2UsXHJcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBWYWxpZGF0ZSBzdHJ1Y3R1cmVcclxuICAgICAgZXhwZWN0KG1vY2tSb29tSW5mby5yb29tSWQpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdChtb2NrUm9vbUluZm8ubmFtZSkudG9CZURlZmluZWQoKTtcclxuICAgICAgZXhwZWN0KG1vY2tSb29tSW5mby5ob3N0SWQpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdChtb2NrUm9vbUluZm8uc3RhdHVzKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QodHlwZW9mIG1vY2tSb29tSW5mby5tZW1iZXJDb3VudCkudG9CZSgnbnVtYmVyJyk7XHJcbiAgICAgIGV4cGVjdCh0eXBlb2YgbW9ja1Jvb21JbmZvLmlzUHJpdmF0ZSkudG9CZSgnYm9vbGVhbicpO1xyXG4gICAgICBleHBlY3QobW9ja1Jvb21JbmZvLmNyZWF0ZWRBdCkudG9CZURlZmluZWQoKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFZhbGlkYXRlIHRpbWVzdGFtcCBmb3JtYXRcclxuICAgICAgZXhwZWN0KCgpID0+IG5ldyBEYXRlKG1vY2tSb29tSW5mby5jcmVhdGVkQXQpKS5ub3QudG9UaHJvdygpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdEZWVwIExpbmsgQWN0aW9uIFN0cnVjdHVyZScsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgY3JlYXRlIHZhbGlkIEpPSU5fUk9PTSBhY3Rpb25zJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBqb2luQWN0aW9uID0ge1xyXG4gICAgICAgIHR5cGU6ICdKT0lOX1JPT00nIGFzIGNvbnN0LFxyXG4gICAgICAgIHJvb21JZDogJ3Jvb20tMTIzJyxcclxuICAgICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgICAgcm9vbU5hbWU6ICdUZXN0IFJvb20nLFxyXG4gICAgICAgICAgaG9zdElkOiAndXNlci00NTYnLFxyXG4gICAgICAgICAgbWVtYmVyQ291bnQ6IDEsXHJcbiAgICAgICAgICBpbnZpdGVDb2RlOiAnQUJDMTIzJyxcclxuICAgICAgICB9LFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgZXhwZWN0KGpvaW5BY3Rpb24udHlwZSkudG9CZSgnSk9JTl9ST09NJyk7XHJcbiAgICAgIGV4cGVjdChqb2luQWN0aW9uLnJvb21JZCkudG9CZURlZmluZWQoKTtcclxuICAgICAgZXhwZWN0KGpvaW5BY3Rpb24ubWV0YWRhdGEpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdChqb2luQWN0aW9uLm1ldGFkYXRhLnJvb21OYW1lKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3Qoam9pbkFjdGlvbi5tZXRhZGF0YS5pbnZpdGVDb2RlKS50b01hdGNoKC9eW0EtWjAtOV17Nn0kLyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSB2YWxpZCBFUlJPUiBhY3Rpb25zJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBlcnJvckFjdGlvbiA9IHtcclxuICAgICAgICB0eXBlOiAnRVJST1InIGFzIGNvbnN0LFxyXG4gICAgICAgIGVycm9yTWVzc2FnZTogJ0ludmFsaWQgaW52aXRlIGxpbmsgZm9ybWF0JyxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGV4cGVjdChlcnJvckFjdGlvbi50eXBlKS50b0JlKCdFUlJPUicpO1xyXG4gICAgICBleHBlY3QoZXJyb3JBY3Rpb24uZXJyb3JNZXNzYWdlKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QodHlwZW9mIGVycm9yQWN0aW9uLmVycm9yTWVzc2FnZSkudG9CZSgnc3RyaW5nJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSB2YWxpZCBJTlZBTElEX0NPREUgYWN0aW9ucycsICgpID0+IHtcclxuICAgICAgY29uc3QgaW52YWxpZEFjdGlvbiA9IHtcclxuICAgICAgICB0eXBlOiAnSU5WQUxJRF9DT0RFJyBhcyBjb25zdCxcclxuICAgICAgICBlcnJvck1lc3NhZ2U6ICdUaGlzIGludml0ZSBsaW5rIGlzIGludmFsaWQgb3IgaGFzIGV4cGlyZWQnLFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgZXhwZWN0KGludmFsaWRBY3Rpb24udHlwZSkudG9CZSgnSU5WQUxJRF9DT0RFJyk7XHJcbiAgICAgIGV4cGVjdChpbnZhbGlkQWN0aW9uLmVycm9yTWVzc2FnZSkudG9CZURlZmluZWQoKTtcclxuICAgICAgZXhwZWN0KHR5cGVvZiBpbnZhbGlkQWN0aW9uLmVycm9yTWVzc2FnZSkudG9CZSgnc3RyaW5nJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0ludGVncmF0aW9uIFByb3BlcnRpZXMnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIG1haW50YWluIFVSTCBmb3JtYXQgY29uc2lzdGVuY3knLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGJhc2VVcmwgPSAnaHR0cHM6Ly90cmluaXR5LmFwcCc7XHJcbiAgICAgIGNvbnN0IHRlc3RDb2RlcyA9IFsnQUJDMTIzJywgJ1hZWjc4OScsICdERUY0NTYnLCAnR0hJMDEyJywgJ0pLTDM0NSddO1xyXG4gICAgICBcclxuICAgICAgdGVzdENvZGVzLmZvckVhY2goY29kZSA9PiB7XHJcbiAgICAgICAgLy8gR2VuZXJhdGUgVVJMXHJcbiAgICAgICAgY29uc3QgdXJsID0gYCR7YmFzZVVybH0vcm9vbS8ke2NvZGV9YDtcclxuICAgICAgICBcclxuICAgICAgICAvLyBFeHRyYWN0IGNvZGUgYmFja1xyXG4gICAgICAgIGNvbnN0IGV4dHJhY3RNZXRob2QgPSAoZGVlcExpbmtTZXJ2aWNlIGFzIGFueSkuZXh0cmFjdEludml0ZUNvZGVGcm9tVXJsO1xyXG4gICAgICAgIGNvbnN0IGV4dHJhY3RlZENvZGUgPSBleHRyYWN0TWV0aG9kLmNhbGwoZGVlcExpbmtTZXJ2aWNlLCB1cmwpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFNob3VsZCBiZSBjb25zaXN0ZW50XHJcbiAgICAgICAgZXhwZWN0KGV4dHJhY3RlZENvZGUpLnRvQmUoY29kZSk7XHJcbiAgICAgICAgZXhwZWN0KHVybCkudG9CZShgJHtiYXNlVXJsfS9yb29tLyR7Y29kZX1gKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlZGdlIGNhc2VzIGluIFVSTCBwYXJzaW5nJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBlZGdlQ2FzZXMgPSBbXHJcbiAgICAgICAgeyB1cmw6ICdodHRwczovL3RyaW5pdHkuYXBwL3Jvb20vQUJDMTIzLycsIGV4cGVjdGVkOiBudWxsIH0sIC8vIFRyYWlsaW5nIHNsYXNoIG5vdCBzdXBwb3J0ZWQgaW4gYmFja2VuZFxyXG4gICAgICAgIHsgdXJsOiAnaHR0cHM6Ly90cmluaXR5LmFwcC9yb29tL0FCQzEyMz9wYXJhbT12YWx1ZScsIGV4cGVjdGVkOiBudWxsIH0sIC8vIFF1ZXJ5IHBhcmFtcyBub3Qgc3VwcG9ydGVkXHJcbiAgICAgICAgeyB1cmw6ICdodHRwczovL3RyaW5pdHkuYXBwL3Jvb20vQUJDMTIzI2ZyYWdtZW50JywgZXhwZWN0ZWQ6IG51bGwgfSwgLy8gRnJhZ21lbnRzIG5vdCBzdXBwb3J0ZWRcclxuICAgICAgXTtcclxuXHJcbiAgICAgIGVkZ2VDYXNlcy5mb3JFYWNoKCh7IHVybCwgZXhwZWN0ZWQgfSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGV4dHJhY3RNZXRob2QgPSAoZGVlcExpbmtTZXJ2aWNlIGFzIGFueSkuZXh0cmFjdEludml0ZUNvZGVGcm9tVXJsO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGV4dHJhY3RNZXRob2QuY2FsbChkZWVwTGlua1NlcnZpY2UsIHVybCk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShleHBlY3RlZCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBpbnZpdGUgY29kZSBmb3JtYXQgY29uc2lzdGVudGx5JywgKCkgPT4ge1xyXG4gICAgICBjb25zdCB2YWxpZENvZGVzID0gWydBQkMxMjMnLCAnWFlaNzg5JywgJ0RFRjQ1NicsICcxMjM0NTYnLCAnQUJDREVGJ107XHJcbiAgICAgIGNvbnN0IGludmFsaWRDb2RlcyA9IFsnQUJDMTInLCAnQUJDREVGRycsICdhYmMxMjMnLCAnQUJDLTIzJywgJ0FCQ18yMyddO1xyXG4gICAgICBcclxuICAgICAgdmFsaWRDb2Rlcy5mb3JFYWNoKGNvZGUgPT4ge1xyXG4gICAgICAgIGV4cGVjdChjb2RlKS50b01hdGNoKC9eW0EtWjAtOV17Nn0kLyk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgICAgaW52YWxpZENvZGVzLmZvckVhY2goY29kZSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KGNvZGUpLm5vdC50b01hdGNoKC9eW0EtWjAtOV17Nn0kLyk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pOyJdfQ==